{% extends 'base.html' %}

{% load static %}

{% block content %}

    <div id="main" class="container-fluid">
        <!-- addItem link -->
        <div id="addItemButton">
            <a class="btn btn-default" href="{% url 'create' %}"
            ><i class="fa fa-plus-square-o"></i> Add New Item</a
            >
        </div>

        <!-- 検索フォーム -->
        <div id="forms">
            <form action="" class="form-inline" role="form" method="GET">
                {{ form.as_p }}
                <button type="submit" class="btn btn-default">
                    <i class="fa fa-angle-double-right"></i> search
                </button>
            </form>
        </div>

        <!-- pagination -->
        {% include 'pagination.html' %}

        <!-- table -->
        <div class="table-responsive">
            <table id="item-table" class="table table-hover table-condensed">
                <thead>
                <tr>
                    <th>name</th>
                    <th>price</th>
                    <th>category</th>
                    <th>brand</th>
                    <th>cond</th>
                </tr>
                </thead>
                <tbody>
                {% for item in item_list %}
                    <tr>
                        <td class="item-name">
                            <a href="{% url 'detail' item.item_id %}">{{ item.name }}</a>
                        </td>
                        <td class="item-price">{{ item.price }}</td>
                        <td class="item-category">
                            {% if item.category %}
                                <a
                                        href="?category={{ item.category.parent.parent.descendant.category_id }}"
                                >{{ item.category.parent.parent.descendant.name }}</a
                                >
                                /
                                <a
                                        href="?category={{ item.category.parent.descendant.category_id }}"
                                >{{ item.category.parent.descendant.name }}</a
                                >
                                /
                                <a href="?category={{ item.category.descendant.category_id }}"
                                >{{ item.category.descendant.name }}</a
                                >
                            {% endif %}
                        </td>
                        <td class="item-brand"><a href="?test=&brand={{ item.brand }}">{{ item.brand }}</a></td>
                        <td class="item-condition">{{ item.condition }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- pagination -->
        {% include 'pagination.html' %}

        <!-- ページ番号を指定して表示するフォーム -->
        <div id="select-page">
            <form class="form-inline" action='' method="GET">
                <div class="form-group">
                    <div class="input-group col-xs-6">
                        <label></label>
                        <input
                                type="text"
                                class="form-control"
                                name="page"
                                value="{{ page_obj.number }}"
                        />
                        {% if form.data.category %}
                            <input
                                    type="hidden"
                                    name="category"
                                    value="{{ form.data.category }}"
                            />
                        {% endif %}
                        {% if form.data.name %}
                            <input
                                    type="hidden"
                                    name="name"
                                    value="{{ form.name.value }}"
                            />
                        {% endif %}
                        {% if form.data.brand %}
                            <input
                                    type="hidden"
                                    name="brand"
                                    value="{{ form.brand.value }}"
                            />
                        {% endif %}
                        <!-- 総ページ数 -->
                        <div class="input-group-addon">
                            {{ page_obj.paginator.num_pages }}
                        </div>
                    </div>
                    <div class="input-group col-xs-1">
                        <button type="submit" class="btn btn-default">Go</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script type="text/javascript" src="{% static 'js/category.js' %}"></script>
{% endblock %}
